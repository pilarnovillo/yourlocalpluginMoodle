{"version":3,"file":"addButton.min.js","sources":["../src/addButton.js"],"sourcesContent":["/*eslint linebreak-style: [\"error\", \"windows\"]*/\r\ndefine(['jquery','core/log','core/ajax'], function($, log, ajax){\r\n    log.debug('Your module is loading2.');\r\n    return {\r\n        init: function(eventData) {\r\n            $(document).ready(function(){\r\n                // log.debug(eventParameter);\r\n                // alert(\"Hiiiii\");\r\n                // Parse the JSON-encoded eventData\r\n                var eventDataObject = JSON.parse(eventData);\r\n\r\n                // // Print the parameter to the console\r\n                log.debug(eventDataObject);\r\n\r\n                var button = document.createElement('button');\r\n\r\n                button.setAttribute('id', 'seleccionarBtn');\r\n                button.textContent = 'Crear nuevo RA';\r\n\r\n                var mainDiv = document.querySelector('div[role=\"main\"]');\r\n                mainDiv.appendChild(button);\r\n\r\n                /**\r\n                        * Function to create\r\n                */\r\n                async function getOAsbyCourseid() {\r\n                    // ...\r\n                    const courseid = eventDataObject.courseid;\r\n\r\n                    const getOAs = async (courseid) => {\r\n                        const response = await ajax.call([{\r\n                            methodname: 'local_yourplugin_get_oa',\r\n                            args: { courseid }\r\n                        }]);\r\n                        return response[0];\r\n                    };\r\n\r\n                    try {\r\n                        const response = await getOAs(courseid);\r\n                        log.debug(response);\r\n\r\n                        response.forEach(function(record) {\r\n                            // Create a button\r\n                            var buttonOA = document.createElement('button');\r\n                            buttonOA.textContent = 'Edit ' + record.name;\r\n\r\n                            // Set the URL\r\n                            var courseid = record.course;\r\n                            var contextid = eventDataObject.contextid;\r\n                            var oaid = record.id; // Assuming 'oaid' is the record's ID\r\n\r\n                            // Set the button's click event to navigate to the desired URL\r\n                            buttonOA.addEventListener('click', function() {\r\n                                var url = 'http://localhost/local/yourplugin/index.php?courseid=' + courseid +\r\n                                        '&contextid=' + contextid + '&oaid=' + oaid;\r\n                                window.location.href = url;\r\n                            });\r\n\r\n                            // Append the button to the container\r\n                            mainDiv.appendChild(buttonOA);\r\n\r\n                        });\r\n\r\n\r\n                    } catch (error) {\r\n                        log.debug('Error fetching OA fields:', error);\r\n                    }\r\n                }\r\n\r\n                getOAsbyCourseid();\r\n\r\n                const createNewOA = (\r\n                    courseid,\r\n                    name,\r\n                ) => ajax.call([{\r\n                    methodname: 'local_yourplugin_store_oa',\r\n                    args: {\r\n                        courseid,\r\n                        name,\r\n                    },\r\n                }])[0];\r\n\r\n                // Add event listener to button\r\n                button.addEventListener('click', async function() {\r\n                    log.debug(\"CLICKED\");\r\n\r\n                    const courseid = eventDataObject.courseid ;\r\n                    const name =\"empty name\";\r\n\r\n                    const response = await createNewOA(courseid, name);\r\n                    var oaid = response[0].id;\r\n\r\n                    // Redirigir a la p√°gina de tu plugin local\r\n                    window.location.href = 'http://localhost/local/yourplugin/index.php?courseid=' + eventDataObject.courseid +\r\n                     \"&contextid=\" + eventDataObject.contextid + \"&oaid=\" + oaid;\r\n                });\r\n\r\n\r\n            });\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","log","ajax","debug","init","eventData","document","ready","eventDataObject","JSON","parse","button","createElement","setAttribute","textContent","mainDiv","querySelector","appendChild","courseid","response","async","call","methodname","args","getOAs","forEach","record","buttonOA","name","course","contextid","oaid","id","addEventListener","url","window","location","href","error","getOAsbyCourseid","createNewOA"],"mappings":"AACAA,oCAAO,CAAC,SAAS,WAAW,cAAc,SAASC,EAAGC,IAAKC,aACvDD,IAAIE,MAAM,4BACH,CACHC,KAAM,SAASC,WACXL,EAAEM,UAAUC,OAAM,eAIVC,gBAAkBC,KAAKC,MAAML,WAGjCJ,IAAIE,MAAMK,qBAENG,OAASL,SAASM,cAAc,UAEpCD,OAAOE,aAAa,KAAM,kBAC1BF,OAAOG,YAAc,qBAEjBC,QAAUT,SAASU,cAAc,oBACrCD,QAAQE,YAAYN,+BAOVO,SAAWV,gBAAgBU,mBAWvBC,cATKC,OAAAA,iBACYlB,KAAKmB,KAAK,CAAC,CAC9BC,WAAY,0BACZC,KAAM,CAAEL,SAAAA,cAEI,GAIOM,CAAON,UAC9BjB,IAAIE,MAAMgB,UAEVA,SAASM,SAAQ,SAASC,YAElBC,SAAWrB,SAASM,cAAc,UACtCe,SAASb,YAAc,QAAUY,OAAOE,SAGpCV,SAAWQ,OAAOG,OAClBC,UAAYtB,gBAAgBsB,UAC5BC,KAAOL,OAAOM,GAGlBL,SAASM,iBAAiB,SAAS,eAC3BC,IAAM,wDAA0DhB,SAC5D,cAAgBY,UAAY,SAAWC,KAC/CI,OAAOC,SAASC,KAAOH,OAI3BnB,QAAQE,YAAYU,aAK1B,MAAOW,OACLrC,IAAIE,MAAM,4BAA6BmC,QAI/CC,GAcA5B,OAAOsB,iBAAiB,SAASb,iBAC7BnB,IAAIE,MAAM,iBAEJe,SAAWV,gBAAgBU,SAG3BC,cAlBU,EAChBD,SACAU,OACC1B,KAAKmB,KAAK,CAAC,CACZC,WAAY,4BACZC,KAAM,CACFL,SAAAA,SACAU,KAAAA,SAEJ,GASuBY,CAAYtB,SAFvB,kBAGRa,KAAOZ,SAAS,GAAGa,GAGvBG,OAAOC,SAASC,KAAO,wDAA0D7B,gBAAgBU,SAChG,cAAgBV,gBAAgBsB,UAAY,SAAWC"}