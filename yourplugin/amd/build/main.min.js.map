{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["/*eslint linebreak-style: [\"error\", \"windows\"]*/\r\n// define(['jquery','core/log', 'core_h5p/editor_display'], function($, log, Editor){\r\n// define(['jquery','core/log','editor_atto'], function($, log, editor_atto){\r\n// import call  from 'core/ajax';\r\ndefine(['jquery','core/log','core/ajax'], function($, log, ajax){\r\n    log.debug('Your module is loading2.');\r\n    return {\r\n        init: function(datos_json) {\r\n            $(document).ready(function(){\r\n                // Convertir los datos JSON de PHP a objetos JavaScript\r\n                var datos = JSON.parse(datos_json);\r\n\r\n                // Hacer algo con los datos\r\n                log.debug(datos);\r\n                var rasAsignaturaArray = [];\r\n                log.debug(\"CHECK IF DRAFT SAVED\");\r\n                // Get the query string portion of the URL.\r\n                var queryString = window.location.search;\r\n\r\n                // Remove the leading '?' character.\r\n                queryString = queryString.substring(1);\r\n\r\n                // Split the query string into an array of key-value pairs.\r\n                var params = queryString.split('&');\r\n\r\n                // Create an object to store the parameters and their values.\r\n                var paramsObject = {};\r\n\r\n                // Iterate over the key-value pairs and populate the paramsObject.\r\n                params.forEach(function(param) {\r\n                    var keyValue = param.split('=');\r\n                    var key = decodeURIComponent(keyValue[0]);\r\n                    var value = decodeURIComponent(keyValue[1]);\r\n                    paramsObject[key] = value;\r\n                });\r\n\r\n                // Now you can access the parameters and their values from the paramsObject.\r\n                var paramCourseid = paramsObject['courseid'];\r\n                log.debug(paramCourseid);\r\n\r\n                var resultadoAprendizajeOA = {\"raasignatura\":[],\r\n                                                \"verbo\":\"\",\r\n                                                \"objeto\":\"\",\r\n                                                \"condicion\":\"\",\r\n                                                \"finalidad\":\"\"\r\n                };\r\n\r\n                //Variable para almacenar los topicos id seleccionados y luego mandar a la Ontologia\r\n                var selectedTopics = [];\r\n\r\n                // Create form elements\r\n                    // var selectTopicosH5P = [];\r\n                    var seleccionarUnidadTitulo = document.createElement('h3');\r\n                    seleccionarUnidadTitulo.textContent = 'Seleccionar Unidad y Topicos:';\r\n\r\n                    /**\r\n                     * Obtiene todas las unidades de los contenidos mínimos en el objeto de datos.\r\n                     *\r\n                     * @param {Object} datos - El objeto que contiene los OA\r\n                     * @returns {string[]} Array de URIs de todas las unidades.\r\n                     */\r\n                    function obtenerUnidadesConTemasYTopicos(datos) {\r\n                        let unidadesConTemasYTopicos = [];\r\n                        // Recorriendo el JSON para obtener la estructura deseada\r\n                        for (const asignaturaUri in datos) {\r\n                            const asignatura = datos[asignaturaUri];\r\n\r\n                            for (const raasignatura in asignatura.RAsAsignatura){\r\n                                rasAsignaturaArray.push(raasignatura);\r\n                            }\r\n\r\n                            for (const contenidoUri in asignatura.contenidosMinimo) {\r\n                                const contenido = asignatura.contenidosMinimo[contenidoUri];\r\n\r\n                                for (const unidadUri in contenido.unidades) {\r\n                                    const unidad = contenido.unidades[unidadUri];\r\n                                    let temasYTopicos = [];\r\n                                    for (const temaUri in unidad.temas) {\r\n                                        let topicos = [];\r\n                                        let topicosYsubs = [];\r\n                                        const tema = unidad.temas[temaUri];\r\n\r\n                                        for (const topicoUri in tema.topicos) {\r\n                                            let partes = [];\r\n                                            // console.log(`Partes: ${topico.partes}`);\r\n                                            // console.log(`Soportes: ${topico.soportes}`);\r\n                                            const topico = tema.topicos[topicoUri];\r\n                                            for (const parteUri in topico.partes) {\r\n                                                partes.push(parteUri\r\n                                                            .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"));\r\n                                            }\r\n                                            topicos.push(topicoUri\r\n                                                        .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"));\r\n                                            topicosYsubs.push({\"topico\":topicoUri,\r\n                                                                \"partes\":partes});\r\n                                        }\r\n                                        temasYTopicos.push({tema: temaUri\r\n                                            .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"),\r\n                                            topicos: topicos,\r\n                                            topicosYsubs: topicosYsubs});\r\n\r\n\r\n                                    }\r\n                                    unidadesConTemasYTopicos.push({\r\n                                        unidad: unidadUri\r\n                                        .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"),\r\n                                        temasYTopicos: temasYTopicos\r\n                                    });\r\n\r\n                            }\r\n                            }\r\n                        }\r\n                        // let unidadesConTemasYTopicos = [];\r\n                        // datos.contenidosMinimo.forEach(contenido => {\r\n                        //     contenido.unidades.forEach(unidad => {\r\n                        //         let temasYTopicos = unidad.temas.map(tema => ({\r\n                        //             tema: tema.uri.replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"),\r\n                        //             topicos: tema.topicos.map(topico =>\r\n                        //                 topico.uri.replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"))\r\n                        //         }));\r\n                        //         unidadesConTemasYTopicos.push({\r\n                        //             unidad: unidad.uri.replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"),\r\n                        //             temasYTopicos: temasYTopicos\r\n                        //         });\r\n                        //     });\r\n                        // });\r\n                        return unidadesConTemasYTopicos;\r\n                    }\r\n\r\n                     // Crear la opción por defecto\r\n                    var defaultOption = document.createElement('option');\r\n                    defaultOption.text = 'Seleccione una opción';\r\n                    defaultOption.value = '';\r\n                    defaultOption.disabled = true;\r\n                    defaultOption.selected = true;\r\n\r\n                    // Crear el elemento select\r\n                    var select = document.createElement('select');\r\n                    select.setAttribute('id', 'id_unidadSelect');\r\n                    select.appendChild(defaultOption);\r\n\r\n                    // Obtener las unidades con sus temas y tópicos y añadirlas al select como opciones\r\n                    var unidadesConTemasYTopicos = obtenerUnidadesConTemasYTopicos(datos);\r\n                    var temasTopicosDic = {};\r\n\r\n                    unidadesConTemasYTopicos.forEach(function(unidadConTemasYTopicos) {\r\n                        var option = document.createElement('option');\r\n                        option.textContent = unidadConTemasYTopicos.unidad;\r\n                        option.value = unidadConTemasYTopicos.unidad.toUpperCase().replace(/\\s+/g, '_');\r\n                        option.dataset.temasYTopicos = JSON.stringify(unidadConTemasYTopicos.temasYTopicos); // Guardar los temas y\r\n                        // log.debug(\"topicosYsubs:\"+JSON.stringify(unidadConTemasYTopicos.temasYTopicos));\r\n                        select.appendChild(option);\r\n                        var i = 1;\r\n                        //info for table later\r\n                        unidadConTemasYTopicos.temasYTopicos.forEach(function(tema){\r\n\r\n                            tema.topicosYsubs.forEach(function(topico){\r\n                                temasTopicosDic[topico.topico\r\n                                    .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\")\r\n                                    .toUpperCase().replace(/\\s+/g, '_')]={\r\n                                    name: topico.topico\r\n                                    .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\"),\r\n                                    order: i,\r\n                                    incluido: {},\r\n                                    parte: topico.partes,\r\n                                    soporte: {}};\r\n                                i++;\r\n                            });\r\n                        });\r\n\r\n                    });\r\n                    // log.debug(\"temasTopicosDic: \"+JSON.stringify(temasTopicosDic));\r\n                    // Append form to container\r\n                    var mainDiv = document.querySelector('div[role=\"main\"]');\r\n                    // var mform = document.getElementsByClassName(\"mform\")[0];\r\n                    // // log.debug(mform);\r\n                    mainDiv.insertBefore(seleccionarUnidadTitulo, mainDiv.firstChild);\r\n                    seleccionarUnidadTitulo.insertAdjacentElement('afterend', select);\r\n\r\n                    // Crear el elemento ul para la lista de temas y tópicos\r\n                    var ul = document.createElement('ul');\r\n                    ul.setAttribute('id', 'listaTemasYTopicos');\r\n                    ul.style.listStyleType = 'none'; // Eliminar los puntos de la lista\r\n\r\n                    select.insertAdjacentElement('afterend', ul);\r\n\r\n\r\n                    // Add event listener to select for change event\r\n                    select.addEventListener('change', function(event) {//TODO si se cambia la Unidad se\r\n                                                         // deseleccionan todos los topicos, borrar del array\r\n                        // selectTopicosH5P = [];\r\n                        var selectedOption = event.target.selectedOptions[0];\r\n                        var temasYTopicos = JSON.parse(selectedOption.dataset.temasYTopicos);\r\n\r\n                        // Limpiar la lista anterior\r\n                        ul.innerHTML = '';\r\n\r\n                        // Añadir los temas y tópicos a la lista\r\n                        temasYTopicos.forEach(item => {\r\n                            var liTema = document.createElement('li');\r\n                            liTema.textContent = item.tema;\r\n                            ul.appendChild(liTema);\r\n\r\n                            item.topicos.forEach(topico => {\r\n                                var liTopico = document.createElement('li');\r\n\r\n                                var checkbox = document.createElement('input');\r\n                                checkbox.type = 'checkbox';\r\n                                checkbox.value = topico.toUpperCase().replace(/\\s+/g, '_');\r\n\r\n                                var label = document.createElement('label');\r\n                                label.textContent = topico;\r\n\r\n                                // log.debug(selectTopicosH5P);\r\n                                label.prepend(checkbox);\r\n\r\n                                liTopico.appendChild(label);\r\n                                liTopico.style.marginLeft = '20px'; // Sangría para los tópicos\r\n                                ul.appendChild(liTopico);\r\n\r\n                                //enventlistener para armar los datos que van en la tabla\r\n                                checkbox.addEventListener('change', function(event) {\r\n                                    // Check the state of the checkbox\r\n                                    if (event.target.checked) {\r\n                                        var tableRow = {name: temasTopicosDic[event.target.value].name,\r\n                                            order: temasTopicosDic[event.target.value].order,\r\n                                            incluido: {},\r\n                                            parte: temasTopicosDic[event.target.value].parte,\r\n                                            ejemplos:\"\",\r\n                                            actividades:\"Definición de límite - Actividad 1\"\r\n                                        };\r\n                                        var select = document.getElementById('menutopic');\r\n                                        var option = document.createElement('option');\r\n                                        option.textContent = temasTopicosDic[event.target.value].name;\r\n                                        option.value = event.target.value;\r\n                                        select.appendChild(option);\r\n                                        fillTable(tableRow, event.target.value);\r\n                                    } else {\r\n                                        removeItemFromTable(event.target.value);\r\n                                        var select = document.getElementById('menutopic');\r\n                                        removeOptionByValue(select,event.target.value);\r\n                                    }\r\n                                });\r\n                            });\r\n                        });\r\n\r\n                        // var select = document.getElementById('menutopic');\r\n                        // if(select){\r\n                        //     var options = selectTopicosH5P;\r\n                        //     // log.debug(selectTopicosH5P);\r\n                        //     options.forEach(function(optionText) {\r\n                        //         var option = document.createElement('option');\r\n                        //         option.textContent = optionText;\r\n                        //         option.value = optionText.toUpperCase().replace(/\\s+/g, '_');\r\n                        //         select.appendChild(option);\r\n                        //     });\r\n                        // }\r\n                    });\r\n\r\n                    var seleccionarRAsTitulo = document.createElement('h3');\r\n                    seleccionarRAsTitulo.textContent = 'Seleccionar Resultados de Aprendizaje de la Asignatura:';\r\n\r\n                    var checkboxesContainer = document.createElement('div'); // Add multiple select element\r\n                    checkboxesContainer.setAttribute('id', 'resultadoAprendizaje'); // Set attributes for multiple select element\r\n                    var resultadosAprendizaje = rasAsignaturaArray;\r\n                    log.debug(\"resultadosAprendizaje: \"+resultadosAprendizaje);\r\n\r\n                    resultadosAprendizaje.forEach(function(raText) {\r\n                        raText = raText.replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\",\"\");\r\n                        var checkbox = document.createElement('input');\r\n                        checkbox.type = 'checkbox';\r\n                        checkbox.value = raText;//.toUpperCase().replace(/\\s+/g, '_'); TODO ver si es necesario\r\n                        var label = document.createElement('label');\r\n                        label.textContent = raText;\r\n                        label.appendChild(checkbox);\r\n                        checkboxesContainer.appendChild(label);\r\n\r\n                        // Crear y añadir un elemento <br> después del label\r\n                        var br = document.createElement('br');\r\n                        checkboxesContainer.appendChild(br);\r\n\r\n                        //enventlistener para armar los datos que van en la ontologia\r\n                        checkbox.addEventListener('change', function(event) {\r\n                            // Check the state of the checkbox\r\n                            if (event.target.checked) {\r\n                                //TODO enviar a la ontologia en el momento?\r\n                                resultadoAprendizajeOA[\"raasignatura\"].push(event.target.value);\r\n\r\n                            } else {\r\n                                //Eliminar ra del array\r\n                                for (let i = resultadoAprendizajeOA[\"raasignatura\"].length - 1; i >= 0; i--) {\r\n                                    if (resultadoAprendizajeOA[\"raasignatura\"][i] === event.target.value) {\r\n                                        resultadoAprendizajeOA[\"raasignatura\"].splice(i, 1);\r\n                                    }\r\n                                }\r\n                            }\r\n                            // log.debug(\"resultadoAprendizajeOA: \"+resultadoAprendizajeOA[\"raasignatura\"]);\r\n                        });\r\n                    });\r\n\r\n                    ul.insertAdjacentElement('afterend',seleccionarRAsTitulo);\r\n                    seleccionarRAsTitulo.insertAdjacentElement('afterend',checkboxesContainer);\r\n\r\n                    // RA para OA\r\n                    var title = document.createElement('h3'); // Título para el resultado de aprendizaje\r\n                    title.textContent = 'Definir el resultado de aprendizaje del Objeto de Aprendizaje';\r\n\r\n                    // Campos de entrada de texto\r\n                    var verboInput = createTextInput('Verbo:');\r\n                    var objetoConocimientoInput = createTextInput('Objeto de Conocimiento:');\r\n                    var condicionInput = createTextInput('Condición:');\r\n                    var finalidadInput = createTextInput('Finalidad:');\r\n\r\n                    checkboxesContainer.insertAdjacentElement('afterend', title);\r\n                    title.insertAdjacentElement('afterend', verboInput);\r\n                    verboInput.insertAdjacentElement('afterend', objetoConocimientoInput);\r\n                    //Check if the OA already has a value for the field\r\n\r\n                    objetoConocimientoInput.insertAdjacentElement('afterend', condicionInput);\r\n                    condicionInput.insertAdjacentElement('afterend', finalidadInput);\r\n\r\n                    //TEST AJAX\r\n\r\n                    const updateVerboOA = (\r\n                        id,\r\n                        name,\r\n                    ) => ajax.call([{\r\n                        methodname: 'local_yourplugin_store_oa_fields',\r\n                        args: {\r\n                            id,\r\n                            name,\r\n                        },\r\n                    }])[0];\r\n\r\n                    const verifyVerbLevel = (\r\n                        raasignatura,\r\n                        verbo,\r\n                    ) => ajax.call([{\r\n                        methodname: 'local_yourplugin_verify_verb_level',\r\n                        args: {\r\n                            raasignatura,\r\n                            verbo,\r\n                        },\r\n                    }])[0];\r\n\r\n                    verboInput.addEventListener('change', async function(event) {\r\n                        // Your event handling code here\r\n                        log.debug('Input VERBO value changed:', event.target.value);\r\n\r\n                        resultadoAprendizajeOA[\"verbo\"] = event.target.value;\r\n                        // log.debug(resultadoAprendizajeOA[\"verbo\"]);\r\n\r\n                        const id = paramsObject['oaid'];\r\n                        const name = event.target.value;\r\n\r\n                        const response = await updateVerboOA(id, name);\r\n                        log.debug(response);\r\n\r\n                        const responseVerbLevel = await verifyVerbLevel(\"RAAsignatura\", name);\r\n                        log.debug(responseVerbLevel);\r\n\r\n                      });\r\n\r\n\r\n\r\n                     /**\r\n                        * Function to create\r\n                        * Manejo de traer las cosas seleccionadas de OA ya creados pero no terminados\r\n                        *seleccionar la unidad y los topicos\r\n                    */\r\n                     async function setOAFields() {\r\n                        // ...\r\n                        const id = paramsObject['oaid'];\r\n\r\n                        const getOAfields = async (id) => {\r\n                            const response = await ajax.call([{\r\n                                methodname: 'local_yourplugin_get_oa_fields',\r\n                                args: { id }\r\n                            }]);\r\n                            return response[0]; // Assuming ajax.call returns an array and you're interested in the first element\r\n                        };\r\n\r\n                        try {\r\n                            const response = await getOAfields(id);\r\n                            log.debug( response[0].name);\r\n\r\n                            var storedName = response[0].name;\r\n                            if(storedName != \"empty name\"){\r\n                                // Select the input element within the container\r\n                                var input = verboInput.querySelector('input');\r\n\r\n                                // Set the value of the input element\r\n                                input.value = storedName;\r\n\r\n                                var selectUnidad = document.getElementById(\"id_unidadSelect\");\r\n\r\n                                //TODO eliminar hardcodeo como es la relacion de OA a UNIDAD?\r\n                                const getOATopicsFromOntology = (\r\n                                    oaid\r\n                                ) => ajax.call([{\r\n                                    methodname: 'local_yourplugin_get_oa_topics',\r\n                                    args: {\r\n                                        oaid\r\n                                    },\r\n                                }])[0];\r\n                                var topicosOntologia = [];\r\n                                try {\r\n                                    const responseOATopicsFromOntology = await getOATopicsFromOntology(paramsObject['oaid']);\r\n                                    log.debug(\"Getting topics:\");\r\n                                    log.debug(responseOATopicsFromOntology);\r\n                                    responseOATopicsFromOntology.forEach(topico => {\r\n                                        var valueTopico = topico.topic\r\n                                        .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\");\r\n                                        topicosOntologia.push(valueTopico);\r\n                                    });\r\n                                } catch (error) {\r\n                                    log.debug('Error fetching OA Topicos: ', error);\r\n                                    log.debug( error);\r\n                                }\r\n\r\n                                var selectedOption = Array.from(selectUnidad.options).find(option => option.value === 'MADUNIDAD1');\r\n\r\n                                selectUnidad.value = selectedOption.value;\r\n\r\n                                var temasYTopicos = JSON.parse(selectedOption.dataset.temasYTopicos);\r\n\r\n                                // Limpiar la lista anterior\r\n                                ul.innerHTML = '';\r\n\r\n\r\n                                // Añadir los temas y tópicos a la lista\r\n                                temasYTopicos.forEach(item => {\r\n                                    var liTema = document.createElement('li');\r\n                                    liTema.textContent = item.tema;\r\n                                    ul.appendChild(liTema);\r\n\r\n                                    item.topicos.forEach(topico => {\r\n                                        var liTopico = document.createElement('li');\r\n\r\n                                        var checkbox = document.createElement('input');\r\n                                        checkbox.type = 'checkbox';\r\n                                        checkbox.value = topico.toUpperCase().replace(/\\s+/g, '_');\r\n\r\n                                        var label = document.createElement('label');\r\n                                        label.textContent = topico;\r\n\r\n                                        // log.debug(selectTopicosH5P);\r\n                                        label.prepend(checkbox);\r\n\r\n                                        liTopico.appendChild(label);\r\n                                        liTopico.style.marginLeft = '20px'; // Sangría para los tópicos\r\n                                        ul.appendChild(liTopico);\r\n\r\n                                        // Establecer el checkbox como seleccionado TODO implemenrar una lista que venga\r\n                                        // desde la ontologia con la data\r\n                                        if(topicosOntologia.includes(checkbox.value)){\r\n                                            checkbox.checked = true;\r\n                                            var tableRow = {name: temasTopicosDic[checkbox.value].name,\r\n                                                order: temasTopicosDic[checkbox.value].order,\r\n                                                incluido: {},\r\n                                                parte: temasTopicosDic[checkbox.value].parte,\r\n                                                ejemplos:\"\",\r\n                                                actividades:\"Definición de límite - Actividad 1\"\r\n                                            };\r\n                                            var select = document.getElementById('menutopic');\r\n                                            var option = document.createElement('option');\r\n                                            option.textContent = temasTopicosDic[checkbox.value].name;\r\n                                            option.value = checkbox.value;\r\n                                            select.appendChild(option);\r\n                                            fillTable(tableRow, checkbox.value);\r\n                                        }\r\n\r\n                                        //enventlistener para armar los datos que van en la tabla/ontologia\r\n                                        checkbox.addEventListener('change', async function(event) {\r\n                                            //Guardar los topicos seleccionados en la Ontologia (MEJOR GUARDAR AUTOMATICALLY\r\n                                                //                  menos llamadas a la ontolgia?? Pero si deselecciono uno?)\r\n                                                const guardarTopicoOA = (\r\n                                                    idTopico,\r\n                                                    oaid,\r\n                                                    selected,//boolean que indica si es para almacenar en el oa o eliminar\r\n                                                ) => ajax.call([{\r\n                                                    methodname: 'local_yourplugin_guardar_topico_oa',\r\n                                                    args: {\r\n                                                        idTopico,\r\n                                                        oaid,\r\n                                                        selected\r\n                                                    },\r\n                                                }])[0];\r\n\r\n                                            // Check the state of the checkbox\r\n                                            if (event.target.checked) {\r\n                                                var tableRow = {name: temasTopicosDic[event.target.value].name,\r\n                                                    order: temasTopicosDic[event.target.value].order,\r\n                                                    incluido: {},\r\n                                                    parte: temasTopicosDic[event.target.value].parte,\r\n                                                    ejemplos:\"\",\r\n                                                    actividades:\"Definición de límite - Actividad 1\"\r\n                                                };\r\n                                                var select = document.getElementById('menutopic');\r\n                                                var option = document.createElement('option');\r\n                                                option.textContent = temasTopicosDic[event.target.value].name;\r\n                                                option.value = event.target.value;\r\n                                                select.appendChild(option);\r\n                                                fillTable(tableRow, event.target.value);\r\n\r\n                                                const response = await guardarTopicoOA(event.target.value,\r\n                                                    paramsObject['oaid'], true);\r\n                                                log.debug(response);\r\n\r\n                                                //Agregar topico a la lista para luego mandarlo a la ontologia\r\n                                                // selectedTopics.push(event.target.value);\r\n                                            } else {\r\n                                                removeItemFromTable(event.target.value);\r\n                                                var select = document.getElementById('menutopic');\r\n                                                removeOptionByValue(select,event.target.value);\r\n\r\n                                                const response = await guardarTopicoOA(event.target.value,\r\n                                                    paramsObject['oaid'], false);\r\n                                                log.debug(response);\r\n                                                // selectedTopics.filter(event.target.value);\r\n                                            }\r\n                                        });\r\n                                    });\r\n                                });\r\n                                //RA Asignatura\r\n\r\n                                const getOAFromOntology = (\r\n                                    id\r\n                                ) => ajax.call([{\r\n                                    methodname: 'local_yourplugin_get_oa_ontology',\r\n                                    args: {\r\n                                        id\r\n                                    },\r\n                                }])[0];\r\n\r\n                                try {\r\n                                    const responseOAFromOntology = await getOAFromOntology(id);\r\n                                    responseOAFromOntology.forEach(ra => {\r\n                                        var valueRaAsig = ra.raasig\r\n                                        .replace(\"http://www.semanticweb.org/valer/ontologies/OntoOA#\", \"\");\r\n                                        let checkboxRaAsig = document\r\n                                        .querySelectorAll(`#resultadoAprendizaje input[type=\"checkbox\"][value=\"${valueRaAsig}\"]`);\r\n                                        checkboxRaAsig[0].checked = true;\r\n                                    });\r\n                                } catch (error) {\r\n                                    log.debug('Error fetching OA RAsAsig: ', error);\r\n                                    log.debug( error);\r\n                                }\r\n\r\n                            }\r\n                        } catch (error) {\r\n                            log.debug('Error fetching OA fields:', error);\r\n                        }\r\n                    }\r\n\r\n                    setOAFields();\r\n                // Function to create text input with label\r\n                /**\r\n                * Function to create text input with label\r\n                * @param {string[]} labelText - j\r\n                */\r\n                function createTextInput(labelText) {\r\n                    var container = document.createElement('div');\r\n                    var label = document.createElement('label');\r\n                    label.textContent = labelText;\r\n                    var input = document.createElement('input');\r\n                    input.setAttribute('type', 'text');\r\n                    container.appendChild(label);\r\n                    container.appendChild(input);\r\n                    return container;\r\n                }\r\n\r\n\r\n                // Create table element\r\n                var tablaTitulo = document.createElement('h3');\r\n                tablaTitulo.textContent = 'Ordenar Topicos:';\r\n                finalidadInput.insertAdjacentElement('afterend', tablaTitulo);\r\n                // var table = document.createElement('table');\r\n                var table = document.getElementsByClassName(\"generaltable\")[0];\r\n\r\n                table.id = 'editableTable';\r\n                // Create thead element\r\n                var thead = document.createElement('thead');\r\n                var headerRow = document.createElement('tr');\r\n                ['','Tópico', 'Order', 'Tópico incluido','Orden Tópico incluido','Tópico Parte',\r\n                'Orden Tópico Parte','Ejemplos', 'Actividades']\r\n                .forEach(function(headerText) {\r\n                    var th = document.createElement('th');\r\n                    th.textContent = headerText;\r\n                    headerRow.appendChild(th);\r\n                });\r\n                thead.appendChild(headerRow);\r\n                table.appendChild(thead);\r\n\r\n                // Create tbody element with sample data\r\n                var tbody = document.createElement('tbody');\r\n\r\n                /**\r\n                     * remove item from table\r\n                     *\r\n                     * @param {String} id - El id de datos.\r\n                */\r\n                function removeItemFromTable(id) {\r\n                    const row = tbody.querySelector(`tr[id=\"${id}\"]`);\r\n                    if (row) {\r\n                        tbody.removeChild(row);\r\n                    }\r\n                }\r\n\r\n                /**\r\n                     * remove item from select\r\n                     *@param {HTMLElement} select - El id de datos.\r\n                     * @param {String} value - El id de datos.\r\n                */\r\n                function removeOptionByValue(select,value) {\r\n                    // var select = document.getElementById(selectId);\r\n                    var options = select.options;\r\n                    for (var i = 0; i < options.length; i++) {\r\n                        if (options[i].value === value) {\r\n                            select.remove(i);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                 /**\r\n                     * fill table\r\n                     *\r\n                     * @param {Array<Object>} data - El array de datos.\r\n                     * @param {String} id - El id de datos.\r\n                */\r\n                function fillTable(data, id) {\r\n                    // rowData.forEach(function(data) {\r\n                        var row = document.createElement('tr');\r\n                        row.setAttribute(\"id\",id);\r\n                        row.style.border = '1px solid black';\r\n                         // Agregar asa de arrastre a la primera celda\r\n                        var dragHandleCell = document.createElement('td');\r\n                        dragHandleCell.className = 'drag-handle';\r\n                        dragHandleCell.textContent = '☰';\r\n                        dragHandleCell.draggable = true; // Asegurar que la celda sea arrastrable\r\n                        row.appendChild(dragHandleCell);\r\n\r\n                        Object.keys(data).forEach(function(key) {\r\n                            var td = document.createElement('td');\r\n                            var tdOrdenIncluido = document.createElement('td');\r\n                            if (key === 'incluido') {\r\n                                // Iterate through the object\r\n                                for (const incluido in data[key]) {\r\n                                    if (data[key].hasOwnProperty(incluido)) {\r\n                                        var div = document.createElement('div');\r\n                                        div.className = 'draggable';\r\n                                        div.draggable = true;\r\n                                        div.textContent = incluido;\r\n                                        td.appendChild(div);\r\n\r\n                                        var divOrdenIncluido = document.createElement('div');\r\n                                        divOrdenIncluido.className = 'draggable';\r\n                                        divOrdenIncluido.draggable = true;\r\n                                        divOrdenIncluido.textContent = data[key][incluido];\r\n                                        tdOrdenIncluido.appendChild(divOrdenIncluido);\r\n                                    }\r\n                                }\r\n                                row.appendChild(td);\r\n                                tdOrdenIncluido.style.border = '1px solid black';\r\n                                row.appendChild(tdOrdenIncluido);\r\n                            }\r\n                            else{\r\n                                td.textContent = data[key];\r\n                                row.appendChild(td);\r\n                            }\r\n                            td.style.border = '1px solid black';\r\n                        });\r\n                        tbody.appendChild(row);\r\n                    // });\r\n                }\r\n\r\n                table.appendChild(tbody);\r\n\r\n                // Add event listeners to editable cells\r\n                table.addEventListener('click', function(event) {\r\n                    var target = event.target;\r\n                    if (target.classList.contains('editable')) {\r\n                        var value = target.textContent;\r\n                        var input = document.createElement('input');\r\n                        input.type = 'text';\r\n                        input.value = value;\r\n                        input.addEventListener('blur', function() {\r\n                            var newValue = this.value;\r\n                            target.textContent = newValue;\r\n                        });\r\n                        target.textContent = '';\r\n                        target.appendChild(input);\r\n                        input.focus();\r\n                    }\r\n                });\r\n\r\n                // Agregar estilos CSS directamente desde JavaScript\r\n                var style = document.createElement('style');\r\n                style.textContent = `\r\n                    .drag-handle {\r\n                        cursor: grab;\r\n                    }\r\n                    .dragging {\r\n                        background-color: lightblue;\r\n                    }\r\n                    .draggable-container {\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                    }\r\n                    .draggable {\r\n                        padding: 10px;\r\n                        border: 1px solid #ccc;\r\n                        background-color: #f9f9f9;\r\n                        margin-bottom: 5px;\r\n                        cursor: move;\r\n                    }\r\n                `;\r\n                document.head.appendChild(style);\r\n\r\n                // Agregar eventos de arrastre\r\n                var draggingElement = null;\r\n\r\n                // Función para manejar el evento de inicio de arrastre\r\n                /**\r\n                 * Función para manejar el evento de inicio de arrastre.\r\n                 * @param {DragEvent} event - El evento de arrastre.\r\n                 */\r\n                function handleDragStart(event){\r\n                    draggingElement = event.target.closest('tr');\r\n                    draggingElement.classList.add('dragging');\r\n                }\r\n\r\n                // Función para manejar el evento de soltar\r\n                /**\r\n                 * Función para manejar el evento de soltar.\r\n                 * @param {DragEvent} event - El evento de soltar.\r\n                 */\r\n                function handleDrop(event) {\r\n                    event.preventDefault();\r\n                    if (draggingElement) {\r\n                        var targetElement = event.target.closest('tr');\r\n                        if (targetElement && targetElement !== draggingElement) {\r\n                            var parent = draggingElement.parentNode;\r\n                            parent.removeChild(draggingElement);\r\n                            var referenceNode = (targetElement.nextSibling &&\r\n                                targetElement.nextSibling.nodeType === Node.ELEMENT_NODE) ?\r\n                                                targetElement.nextSibling : null;\r\n                            parent.insertBefore(draggingElement, referenceNode);\r\n                        }\r\n                        draggingElement.classList.remove('dragging');\r\n                        draggingElement = null;\r\n                    }\r\n                }\r\n\r\n                // Agregar eventos de arrastre a las celdas de asa de arrastre\r\n                var dragHandleElements = document.querySelectorAll('.drag-handle');\r\n                dragHandleElements.forEach(function(element) {\r\n                    element.addEventListener('dragstart', handleDragStart);\r\n                });\r\n                tbody.addEventListener('dragover', function(event) {\r\n                    event.preventDefault();\r\n                });\r\n                tbody.addEventListener('drop', handleDrop);\r\n\r\n                // Append the table to the container\r\n                tablaTitulo.insertAdjacentElement('afterend', table);\r\n\r\n                var editarcrearTitulo = document.createElement('h3');\r\n                editarcrearTitulo.textContent = 'Crear o editar H5P:';\r\n                table.insertAdjacentElement('afterend', editarcrearTitulo);\r\n\r\n                var formElements = document.getElementsByTagName(\"form\");\r\n                var h5pform = formElements[1];\r\n                log.debug(h5pform);\r\n                // var metadatosTitulo = document.createElement('h3');\r\n                // metadatosTitulo.textContent = 'Completar Metadatos:';\r\n                // h5pform.insertAdjacentElement('afterend', metadatosTitulo);\r\n                var buttonFin = document.createElement('button');\r\n\r\n                buttonFin.setAttribute('id', 'finBtn');\r\n                buttonFin.textContent = 'Finalizar OA';\r\n\r\n                // Add event listener to button\r\n                buttonFin.addEventListener('click', async function() {\r\n                    log.debug(\"CLICKED\");\r\n\r\n                    // Redirigir a la página de tu plugin local\r\n                    window.location.href = 'http://localhost/local/yourplugin/metadatos.php?courseid=' + paramCourseid\r\n                    + '&oaid=' + paramsObject['oaid'];\r\n                });\r\n\r\n                h5pform.insertAdjacentElement('afterend', buttonFin);\r\n\r\n                let draggedElement = null;\r\n\r\n                document.querySelectorAll('.draggable').forEach(item => {\r\n                    item.addEventListener('dragstart', function(e) {\r\n                        draggedElement = this;\r\n                        e.dataTransfer.effectAllowed = 'move';\r\n                        e.dataTransfer.setData('text/html', this.innerHTML);\r\n                    });\r\n\r\n                    item.addEventListener('dragover', function(e) {\r\n                        if (e.preventDefault) {\r\n                            e.preventDefault();\r\n                        }\r\n                        return false;\r\n                    });\r\n\r\n                    item.addEventListener('drop', function(e) {\r\n                        if (e.stopPropagation) {\r\n                            e.stopPropagation();\r\n                        }\r\n\r\n                        if (draggedElement !== this) {\r\n                            draggedElement.innerHTML = this.innerHTML;\r\n                            this.innerHTML = e.dataTransfer.getData('text/html');\r\n                        }\r\n\r\n                        return false;\r\n                    });\r\n                });\r\n\r\n                /**\r\n                     * saveChanges\r\n                     *\r\n                */\r\n                async function saveChanges() {\r\n                    // fetch('/save_changes.php', {\r\n                    //     method: 'POST',\r\n                    //     headers: {\r\n                    //         'Content-Type': 'application/json',\r\n                    //     },\r\n                    //     body: JSON.stringify({ /* datos a guardar */ }),\r\n                    // })\r\n                    // .then(response => response.json())\r\n                    // .then(data => {\r\n                    //     console.log('Success:', data);\r\n                    // })\r\n                    // .catch((error) => {\r\n                    //     console.error('Error:', error);\r\n                    // });\r\n                    const saveChangesOnOntology = (\r\n                        oaid,\r\n                        raoa,\r\n                        contenidos,\r\n                        actividades,\r\n                        metadatos,\r\n                    ) => ajax.call([{\r\n                        methodname: 'local_yourplugin_save_changes_automatically',\r\n                        args: {\r\n                            oaid,\r\n                            raoa,\r\n                            contenidos,\r\n                            actividades,\r\n                            metadatos,\r\n                        },\r\n                    }])[0];\r\n\r\n                    var input = verboInput.querySelector('input');\r\n                    resultadoAprendizajeOA[\"verbo\"] = input.value;\r\n                    log.debug(\"resultadoAprendizajeOA:\",resultadoAprendizajeOA[\"verbo\"]);\r\n                    const saveChangesOnOntologyResponse =\r\n                     await saveChangesOnOntology(paramsObject['oaid'], resultadoAprendizajeOA, selectedTopics,[],[]);\r\n                    log.debug(saveChangesOnOntologyResponse);\r\n                    log.debug(\"RUN saveChanges\");\r\n                }\r\n                var input = verboInput.querySelector('input');\r\n                log.debug(\"verbo: \", input.value);\r\n                setInterval(saveChanges, 150000); // Cada 5 minutos\r\n\r\n                var saveChangesButtonH5P = document.getElementById('id_submitbutton');\r\n                log.debug(\"saveChangesButton:\" + saveChangesButtonH5P);\r\n                log.debug(saveChangesButtonH5P);\r\n\r\n                //move error message to correct place\r\n                var errorMessage = document.getElementById(\"error-message\");\r\n                if (errorMessage){\r\n                    saveChangesButtonH5P.insertAdjacentElement('afterend', errorMessage);\r\n                }\r\n                // if(saveChangesButtonH5P){\r\n                    // saveChangesButtonH5P.addEventListener('click', function(event) {\r\n                        // event.preventDefault();\r\n                        // // Create the modal dialog\r\n                        // var modal = document.createElement('div');\r\n                        // modal.style.position = 'fixed';\r\n                        // modal.style.top = '50%';\r\n                        // modal.style.left = '50%';\r\n                        // modal.style.transform = 'translate(-50%, -50%)';\r\n                        // modal.style.zIndex = '1000';\r\n                        // modal.style.padding = '20px';\r\n                        // modal.style.backgroundColor = 'white';\r\n                        // modal.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';\r\n\r\n                        // var question = document.createElement('p');\r\n                        // question.textContent = 'Are you sure you want to continue?';\r\n                        // modal.appendChild(question);\r\n\r\n                        // var cancelButton = document.createElement('button');\r\n                        // cancelButton.textContent = 'Cancel';\r\n                        // cancelButton.addEventListener('click', function() {\r\n                        //     // event.preventDefault();\r\n                        //     // Find the H5P editor container element\r\n                        //     // var h5pEditorContainer = $('.h5p-editor');\r\n\r\n                        //     // // Check if the container is found\r\n                        //     // if (h5pEditorContainer) {\r\n                        //     //     // Get the H5P editor instance from the container\r\n                        //     //     // var H5P;\r\n                        //     //     // Use H5P here\r\n                        //     //     var h5pEditorInstance = window.H5P.jQuery(h5pEditorContainer).data('h5peditor');\r\n                        //     //     // Check if the editor instance is found\r\n                        //     //     if (h5pEditorInstance) {\r\n                        //     //         log.debug('H5P Editor instance found:', h5pEditorInstance);\r\n\r\n                        //     //         // Get the current content of the H5P editor\r\n                        //     //         h5pEditorInstance.getContent(function(content) {\r\n                        //     //             log.debug('H5P Editor content:', content);\r\n                        //     //         });\r\n                        //     //     } else {\r\n                        //     //         log.debug('H5P editor instance not found');\r\n                        //     //     }\r\n                        //     // } else {\r\n                        //     //     log.debug('H5P editor container not found');\r\n                        //     // }\r\n                        //     // var h5peditor;\r\n                        //     // const editor = $('.h5p-editor');\r\n                        //     // const library = $('input[name=\"h5plibrary\"]');\r\n                        //     // const params = $('input[name=\"h5pparams\"]');\r\n                        //     // if (h5peditor === undefined) {\r\n                        //     //     h5peditor = new ns.Editor(library.val(), params.val(), editor[0]);\r\n                        //     // }\r\n                        //     // h5peditor.getContent(function(content) {\r\n                        //     //     log.debug('H5P Editor content:', content);\r\n                        //     // });\r\n                        //     log.debug('Logging form fields:');\r\n                        //     Array.from(document.getElementById('coolh5peditor').elements).forEach(element => {\r\n                        //         if (element.name) {\r\n                        //             log.debug(element.name + ': ' + element.value);\r\n                        //         }\r\n                        //     });\r\n                        //     // Get form data\r\n                        //     var formData = new FormData(document.getElementById('coolh5peditor'));\r\n                        //     formData.forEach(function(value, key){\r\n                        //         log.debug(key + ': ' + value);\r\n                        //     });\r\n                        //     document.body.removeChild(modal);\r\n                        // });\r\n                        // modal.appendChild(cancelButton);\r\n\r\n                        // var continueButton = document.createElement('button');\r\n                        // continueButton.textContent = 'Continue';\r\n                        // continueButton.style.marginLeft = '10px';\r\n                        // continueButton.addEventListener('click', function() {\r\n                        //     // Perform the new action here\r\n                        //     document.body.removeChild(modal);\r\n                        //     document.getElementById('coolh5peditor').submit();\r\n                        // });\r\n                        // modal.appendChild(continueButton);\r\n\r\n                        // document.body.appendChild(modal);\r\n                    // });\r\n                // }\r\n            });\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","log","ajax","debug","init","datos_json","document","ready","datos","JSON","parse","rasAsignaturaArray","queryString","window","location","search","params","substring","split","paramsObject","forEach","param","keyValue","key","decodeURIComponent","value","paramCourseid","resultadoAprendizajeOA","selectedTopics","seleccionarUnidadTitulo","createElement","textContent","defaultOption","text","disabled","selected","select","setAttribute","appendChild","unidadesConTemasYTopicos","asignaturaUri","asignatura","raasignatura","RAsAsignatura","push","contenidoUri","contenidosMinimo","contenido","unidadUri","unidades","unidad","temasYTopicos","temaUri","temas","topicos","topicosYsubs","tema","topicoUri","partes","topico","parteUri","replace","obtenerUnidadesConTemasYTopicos","temasTopicosDic","unidadConTemasYTopicos","option","toUpperCase","dataset","stringify","i","name","order","incluido","parte","soporte","mainDiv","querySelector","insertBefore","firstChild","insertAdjacentElement","ul","style","listStyleType","addEventListener","event","selectedOption","target","selectedOptions","innerHTML","item","liTema","liTopico","checkbox","type","label","prepend","marginLeft","checked","tableRow","ejemplos","actividades","getElementById","fillTable","removeItemFromTable","removeOptionByValue","seleccionarRAsTitulo","checkboxesContainer","resultadosAprendizaje","raText","br","length","splice","title","verboInput","createTextInput","objetoConocimientoInput","condicionInput","finalidadInput","labelText","container","input","async","id","response","call","methodname","args","updateVerboOA","responseVerbLevel","verbo","getOAfields","storedName","selectUnidad","getOATopicsFromOntology","oaid","topicosOntologia","responseOATopicsFromOntology","valueTopico","topic","error","Array","from","options","find","includes","guardarTopicoOA","idTopico","getOAFromOntology","ra","valueRaAsig","raasig","querySelectorAll","setOAFields","tablaTitulo","table","getElementsByClassName","thead","headerRow","headerText","th","tbody","row","removeChild","remove","data","border","dragHandleCell","className","draggable","Object","keys","td","tdOrdenIncluido","hasOwnProperty","div","divOrdenIncluido","classList","contains","newValue","this","focus","head","draggingElement","handleDragStart","closest","add","element","preventDefault","targetElement","parent","parentNode","referenceNode","nextSibling","nodeType","Node","ELEMENT_NODE","editarcrearTitulo","h5pform","getElementsByTagName","buttonFin","href","draggedElement","e","dataTransfer","effectAllowed","setData","stopPropagation","getData","setInterval","saveChangesOnOntologyResponse","raoa","contenidos","metadatos","saveChangesButtonH5P","errorMessage"],"mappings":"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"}